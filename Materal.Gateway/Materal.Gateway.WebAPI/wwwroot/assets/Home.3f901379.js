import{i as f,j as S,F as D,l as b,m as y,A as w,r as _,o as F,n as x,q as a,w as u,G as B,t as g,E as N,H as k,I as q,s as h,c as H,v as R,p as T,J as A,K as M,D as V,L as j,M as K}from"./vendor.6fdda690.js";import{_ as C}from"./index.090d5720.js";import{u as E,r as L,a as $}from"./useRequest.a29580a0.js";const z=g("\u65B0\u589E"),I=f({props:{loading:null},setup(l){const o=S(),i=D(),n=b(""),s=y(()=>i.query.serviceName);w(()=>s.value,()=>n.value=s.value,{immediate:!0});function e(){o.push({query:{serviceName:n.value}})}return(r,t)=>{const c=_("el-button"),p=_("el-input"),m=_("router-link");return F(),x("div",null,[a(p,{disabled:l.loading,modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=d=>n.value=d),modelModifiers:{trim:!0},placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0\u6216\u670D\u52A1\u540D\u79F0",class:"input",clearable:"",onKeypress:B(e,["enter"])},{append:u(()=>[a(c,{loading:l.loading,onClick:e,icon:"el-icon-search"},null,8,["loading"])]),_:1},8,["disabled","modelValue","onKeypress"]),a(m,{to:{name:"Add"}},{default:u(()=>[a(c,{type:"primary",class:"add-btn"},{default:u(()=>[z]),_:1})]),_:1})])}}});var U=C(I,[["__scopeId","data-v-7d14368d"]]);const G={class:"toolbar"},J=g("\u7F16\u8F91"),P=g("\u5220\u9664 "),O=f({props:{data:null,loading:null},emits:["update:loading","refresh"],setup(l,{emit:o}){const{loading:i,run:n}=E(L.delete,{manual:!0,onSuccess:e=>{N.success(e.message),o("refresh")}});w(()=>i.value,e=>{o("update:loading",e)});async function s(e){await A.confirm("\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\uFF0C\u662F\u5426\u7EE7\u7EED\u5220\u9664\uFF1F","\u8B66\u544A",{type:"warning",confirmButtonText:"\u5220\u9664",cancelButtonText:"\u53D6\u6D88"}).catch(()=>{})==="confirm"&&await n(e)}return(e,r)=>{const t=_("el-table-column"),c=_("el-button"),p=_("router-link"),m=_("el-table"),d=k("loading");return q((F(),H(m,{data:l.data},{default:u(()=>[a(t,{label:"\u540D\u79F0",prop:"serviceName"}),a(t,{label:"\u7F13\u5B58",width:"80"},{default:u(({row:v})=>[g(R(v.enableCache?"\u542F\u7528":"\u7981\u7528"),1)]),_:1}),a(t,{label:"\u64CD\u4F5C",width:"150"},{default:u(({row:v})=>[T("span",G,[a(p,{to:{name:"Add",query:{serviceName:v.serviceName}}},{default:u(()=>[a(c,{type:"text"},{default:u(()=>[J]),_:1})]),_:2},1032,["to"]),a(c,{class:"danger",onClick:X=>s(v.serviceName),type:"text"},{default:u(()=>[P]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[d,h(i)]])}}});var Q=C(O,[["__scopeId","data-v-3dfd3ee1"]]);function W(){const l=b(0);M(()=>{o(),window.addEventListener("resize",o)}),V(()=>{window.addEventListener("resize",o)});function o(){var t;const i=window.innerHeight,n=((t=document.querySelector(".header"))==null?void 0:t.clientHeight)||0,s=document.querySelector(".main"),e=s&&window.getComputedStyle(s);let r=0;e&&(r=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),l.value=i-n-r}return l}const te=f({setup(l){const{routeService:o}=$(),i=D(),n=b([]),s=y(()=>i.query.serviceName),{loading:e,run:r}=E(()=>o.getList(s.value),{onSuccess:p=>n.value=p.data,refreshDeps:[s]}),t=W(),c=y(()=>t.value-40);return(p,m)=>(F(),x("div",{class:"service-container",ref:(d,v)=>{v.rootEl=d},style:K({height:h(t)+"px"})},[a(U,{loading:h(e)},null,8,["loading"]),a(Q,{data:n.value,height:h(c),loading:h(e),"onUpdate:loading":m[0]||(m[0]=d=>j(e)?e.value=d:null),onRefresh:h(r)},null,8,["data","height","loading","onRefresh"])],4))}});export{te as default};
