import{r as _,o as g,c as y,a as f,b as F,d as k,e as w,f as A,E as D,g as L,h as T}from"./vendor.6fdda690.js";const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}};B();var C=(t,e)=>{for(const[o,n]of e)t[o]=n;return t};const x={};function O(t,e){const o=_("router-view");return g(),y(o)}var b=C(x,[["render",O]]);const I="modulepreload",m={},v="/",a=function(e,o){return!o||o.length===0?e():Promise.all(o.map(n=>{if(n=`${v}${n}`,n in m)return;m[n]=!0;const r=n.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${s}`))return;const u=document.createElement("link");if(u.rel=r?"stylesheet":I,r||(u.as="script",u.crossOrigin=""),u.href=n,document.head.appendChild(u),r)return new Promise((h,E)=>{u.addEventListener("load",h),u.addEventListener("error",E)})})).then(()=>e())},l="token",P={namespaced:!0,state:()=>({token:null}),mutations:{SET_TOKEN(t,e){t.token=e,e?f.set(l,e,{expires:60*60*24}):f.remove(l)}},actions:{initToken({commit:t}){const e=f.get(l);e&&t("SET_TOKEN",e)}}};var i=F({modules:{user:P},actions:{logout({commit:t}){t("user/SET_TOKEN",null)}}});function R(t){t.beforeEach((e,o,n)=>{var r;((r=e.meta)==null?void 0:r.auth)&&!i.state.user.token&&e.name!=="Login"?n({name:"Login"}):n()})}const d=k({history:w(),routes:[{path:"/login",name:"Login",component:()=>a(()=>import("./Login.3efb2aef.js"),["assets/Login.3efb2aef.js","assets/Login.67ba3e84.css","assets/useRequest.a29580a0.js","assets/vendor.6fdda690.js"])},{path:"/",component:()=>a(()=>import("./HomeLayout.706685a9.js"),["assets/HomeLayout.706685a9.js","assets/HomeLayout.d63671b4.css","assets/vendor.6fdda690.js"]),children:[{path:"/",name:"Home",meta:{auth:!0},component:()=>a(()=>import("./Home.3f901379.js"),["assets/Home.3f901379.js","assets/Home.ac7d5ce1.css","assets/vendor.6fdda690.js","assets/useRequest.a29580a0.js"])},{path:"/add",name:"Add",meta:{auth:!0},component:()=>a(()=>import("./Add.1f056be7.js"),["assets/Add.1f056be7.js","assets/useRequest.a29580a0.js","assets/vendor.6fdda690.js"])}]}]});R(d);let p;function j(){p=A.create({baseURL:"/api/",validateStatus:t=>[400,200,404,401].includes(t),headers:{Accept:"*","Content-Type":"application/json"}})}function S(){if(!p)throw new Error("axios\u8FD8\u672A\u521D\u59CB\u5316");return p}function N(t){return function(e){e.interceptors.request.use(function(o){const n=t.token();return o.headers&&n&&(o.headers.Authorization=n),o})}}function K(t){let e="";for(let o in t)e+=`${t[o].join(",")}
`;return e}class H extends Error{constructor(e){const o=K(e);super(o);this.message=o}}function $(){return function(t){t.interceptors.response.use(e=>{if(e.status===400)throw new H(e.data.errors);if(e.status===404)throw new Error("\u8BF7\u6C42\u5730\u5740\u4E0D\u5B58\u5728\uFF1A"+e.config.url);if(e.status===401){const n=i.state.user.token?"\u767B\u5F55\u5DF2\u8FC7\u671F\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55":"\u6743\u9650\u4E0D\u8DB3\uFF0C\u8BF7\u767B\u5F55\u540E\u518D\u64CD\u4F5C";i.dispatch("logout").then(()=>{throw d.push({name:"Login"}),D.warning(n),new Error(n)})}if(e.status===200&&typeof e.data=="object"&&"resultType"in e.data&&e.data.resultType===1)throw new Error(e.data.message);return e.data},e=>{throw console.log(e.message),e.message.includes("timeout")?new Error("\u8BF7\u6C42\u8D85\u65F6"):e.message.includes("Network Error")?new Error("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5\u3002"):e})}}function q(t){const e=S();t.forEach(o=>{typeof o=="function"&&o(e)})}j();q([N({token:()=>i.state.user.token}),$()]);i.dispatch("user/initToken");const c=L(b);c.use(d);c.use(i);c.use(T);c.mount("#app");export{C as _,S as u};
